<nav
  class="
    navbar navbar-expand navbar-dark
    bg-color
    position-fixed
    w-100
    top-0
    navbar-home
  "
>
  <div class="container-fluid">
    <a class="navbar-brand" routerLink="/home">Insinia</a>
    <div class="d-flex justify-content-center">
      <ul class="navbar-nav">
        <li class="nav-item">
          <button class="nav-link btn active" routerLink="/home">
            <i class="bi bi-house-door-fill"></i>
          </button>
        </li>
        <li class="nav-item">
          <button class="nav-link btn" routerLink="/login">
            <i class="bi bi-person-circle"></i>
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container text-color">
  <div class="border-0 shadow-sm card-hover-primary">
    <div class="row justify-content-center">
      <div id="content" class="content">
        <div class="row">
          <div class="ms-3 col-auto col-sm-auto">
            <img
              [@fadeIn]
              *ngIf="profile && profile.avatar"
              [src]="profile.avatar"
              class="thumbnails img-fluid"
            />
            <img [@fadeIn] *ngIf="!profile" class="thumbnails img-fluid" />
          </div>
          <div *ngIf="profile" class="col-auto">
            <h2 class="m-0">{{ profile.name + " " + profile.lastName }}</h2>
            <small>Te uniste el {{ profile.dateJoined }}</small
            ><br />
            <small>{{ profile.description }}</small>
          </div>
          <div *ngIf="!profile" class="col-9 col-xxl-7">
            <button
              class="btn btn-sm form-control-loading loading-10 mb-2"
            ></button>
            <button
              class="btn btn-sm form-control-loading loading-25 mb-2"
            ></button>
            <button class="btn btn-sm form-control-loading loading-50"></button>
          </div>
        </div>
      </div>
    </div>

    <ul class="list-group list-group-horizontal mt-2">
      <button
        *ngIf="profile"
        class="btn btn-sm btn-color text-light"
        data-bs-toggle="modal"
        data-bs-target="#profilePictureModal"
      >
        Cambiar foto
      </button>
      <button
        *ngIf="!profile"
        class="btn btn-sm form-control-loading button-loading loading-10"
      ></button>
    </ul>

    <div class="row justify-content-center">
      <div [@fadeIn] class="col-lg rounded p-4">
        <h4 class="mb-3">Editar tu perfil</h4>
        <form [formGroup]="profileForm" (ngSubmit)="updateSubmit()">
          <div class="row g-3">
            <div class="col-sm">
              <label for="name" class="form-label">Nombre</label>
              <input
                *ngIf="profile && profile.name"
                [@fadeIn]
                type="text"
                formControlName="name"
                placeholder="{{ profile.name }}"
                class="form-control"
              />
              <input
                *ngIf="!profile"
                [@fadeIn]
                type="text"
                class="form-control-loading"
              />
              <div *ngIf="profileForm.controls.name.errors">
                <small
                  [@fadeIn]
                  class="text-danger"
                  *ngIf="
                    profileForm.controls.name.touched &&
                    profileForm.controls.name.errors['minlength']
                  "
                  ><i class="bi bi-x me-2"></i>La longitud debe ser de 8
                  caracteres.</small
                >
                <small
                  [@fadeIn]
                  class="text-danger"
                  *ngIf="
                    profileForm.controls.name.touched &&
                    profileForm.controls.name.errors['required']
                  "
                  ><i class="bi bi-x me-2"></i>Este campo es obligatorio.</small
                >
              </div>
            </div>

            <div class="col-sm">
              <label for="lastName" class="form-label">Apellidos</label>
              <input
                *ngIf="profile && profile.lastName"
                [@fadeIn]
                type="text"
                formControlName="lastName"
                class="form-control"
                placeholder="{{ profile.lastName }}"
              />
              <input
                *ngIf="!profile"
                [@fadeIn]
                type="text"
                class="form-control-loading"
              />
              <div *ngIf="profileForm.controls.lastName.errors">
                <small
                  [@fadeIn]
                  class="text-danger"
                  *ngIf="
                    profileForm.controls.lastName.touched &&
                    profileForm.controls.lastName.errors['minlength']
                  "
                  ><i class="bi bi-x me-2"></i>La longitud debe ser de 8
                  caracteres.</small
                >
                <small
                  [@fadeIn]
                  class="text-danger"
                  *ngIf="
                    profileForm.controls.lastName.touched &&
                    profileForm.controls.lastName.errors['required']
                  "
                  ><i class="bi bi-x me-2"></i>Este campo es obligatorio.</small
                >
              </div>
            </div>

            <div class="col-12">
              <label for="username" class="form-label">Nick</label>
              <div class="input-group has-validation">
                <input
                  *ngIf="profile && profile.nick"
                  [@fadeIn]
                  type="text"
                  formControlName="nick"
                  class="form-control"
                  placeholder="{{ profile.nick }}"
                />
                <input
                  *ngIf="!profile"
                  [@fadeIn]
                  type="text"
                  class="form-control-loading"
                />
              </div>
              <div *ngIf="profileForm.controls.nick.errors">
                <small
                  [@fadeIn]
                  class="text-danger"
                  *ngIf="
                    profileForm.controls.nick.touched &&
                    profileForm.controls.nick.errors['minlength']
                  "
                  ><i class="bi bi-x me-2"></i>La longitud debe ser de 8
                  caracteres.</small
                >
                <small
                  [@fadeIn]
                  class="text-danger"
                  *ngIf="
                    profileForm.controls.nick.touched &&
                    profileForm.controls.nick.errors['required']
                  "
                  ><i class="bi bi-x me-2"></i>Este campo es obligatorio.</small
                >
              </div>
            </div>

            <div class="col-sm-12">
              <label for="email" class="form-label">Email</label>
              <input
                *ngIf="profile && profile.email"
                [@fadeIn]
                type="text"
                formControlName="email"
                class="form-control"
                placeholder="{{ profile.email }}"
              />
              <input
                *ngIf="!profile"
                [@fadeIn]
                type="text"
                class="form-control-loading"
              />
              <div *ngIf="profileForm.controls.email.errors">
                <small
                  [@fadeIn]
                  class="text-danger"
                  *ngIf="
                    profileForm.controls.email.touched &&
                    profileForm.controls.email.errors['minlength']
                  "
                  ><i class="bi bi-x me-2"></i>La longitud debe ser de 8
                  caracteres.</small
                >
                <small
                  [@fadeIn]
                  class="text-danger"
                  *ngIf="
                    profileForm.controls.email.touched &&
                    profileForm.controls.email.errors['required']
                  "
                  ><i class="bi bi-x me-2"></i>Este campo es obligatorio.</small
                >
              </div>
            </div>

            <div class="col-sm-12">
              <label for="dateBirth" class="form-label"
                >Fecha de nacimiento</label
              >
              <input
                *ngIf="profile && profile.dateBirth"
                [@fadeIn]
                type="date"
                formControlName="dateBirth"
                class="form-control"
              />
              <input
                *ngIf="!profile"
                [@fadeIn]
                type="text"
                class="form-control-loading"
              />
              <div *ngIf="profileForm.controls.dateBirth.errors">
                <small
                  [@fadeIn]
                  class="text-danger"
                  *ngIf="
                    profileForm.controls.dateBirth.touched &&
                    profileForm.controls.dateBirth.errors['minlength']
                  "
                  ><i class="bi bi-x me-2"></i>La longitud debe ser de 8
                  caracteres.</small
                >
                <small
                  [@fadeIn]
                  class="text-danger"
                  *ngIf="
                    profileForm.controls.dateBirth.touched &&
                    profileForm.controls.dateBirth.errors['required']
                  "
                  ><i class="bi bi-x me-2"></i>Este campo es obligatorio.</small
                >
              </div>
            </div>

            <div class="col-sm-12">
              <label for="description" class="form-label">Descripci√≥n</label>
              <textarea
                *ngIf="profile && profile.description"
                [@fadeIn]
                type="text"
                formControlName="description"
                class="form-control"
              ></textarea>
              <textarea
                *ngIf="!profile"
                [@fadeIn]
                type="text"
                class="form-control-loading"
              ></textarea>
              <div *ngIf="profileForm.controls.description.errors">
                <small
                  [@fadeIn]
                  class="text-danger"
                  *ngIf="
                    profileForm.controls.description.touched &&
                    profileForm.controls.description.errors['minlength']
                  "
                  ><i class="bi bi-x me-2"></i>La longitud debe ser de 8
                  caracteres.</small
                >
                <small
                  [@fadeIn]
                  class="text-danger"
                  *ngIf="
                    profileForm.controls.description.touched &&
                    profileForm.controls.description.errors['required']
                  "
                  ><i class="bi bi-x me-2"></i>Este campo es obligatorio.</small
                >
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<div
  class="modal fade"
  id="profilePictureModal"
  tabindex="-1"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header p-3 text-light bg-color">
        <h2 class="modal-title">Cambio de foto de perfil</h2>
        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <div class="container-fluid">
          <div *ngIf="profile" class="row text-center mb-2">
            <div class="col text-center">
              <h3>Esta es tu foto ahora</h3>
              <img
                [src]="profile.avatar"
                class="img-fluid"
                style="width: 12em"
              />
            </div>
            <div *ngIf="image && image.base" class="col text-center">
              <h3>La imagen que vas a subir</h3>
              <img [src]="image.base" class="img-fluid" style="width: 12em" />
            </div>
          </div>
          <div class="row text-center">
            <h3 *ngIf="!image.name">Selecciona una imagen para cambiar tu foto de perfil</h3>
            <form class="col">
              <label
                #profilePictureLabel
                for="profilePicture"
                class="form-control-img"
                >Selecciona una foto</label
              >
              <input
                #profilePicture
                name="profilePicture"
                id="profilePicture"
                type="file"
                accept="image/png, image/jpg, image/jpeg, image/svg"
                class="hide"
                (change)="readURL($event)"
              />
            </form>
          </div>
        </div>
      </div>
      <div class="modal-footer border-0">
        <button
          (click)="updateProfilePicture()"
          class="btn btn-sm btn-color text-light"
        >
          Cambiar imagen
        </button>
        <button
          type="button"
          class="btn btn-sm btn-secondary"
          data-bs-dismiss="modal"
        >
          Cerrar
        </button>
      </div>
    </div>
  </div>
</div>
